select 
CONCAT(e.first_name,' ',e.last_name) as name, -- имя и фамилия продавца
ROUND(AVG(p.price*s.quantity),0) as average_income --средняя выручка продавца за сделку с округлением до целого
from
employees as e
join sales as s on
s.sales_person_id=e.employee_id
join products as p on
p.product_id = s.product_id
GROUP BY
  e.employee_id, e.first_name, e.last_name
HAVING
  avg(p.price * s.quantity) < (SELECT AVG(p.price * s.quantity) 
  FROM employees e 
  JOIN sales s 
  ON s.sales_person_id = e.employee_id 
  JOIN products p 
  ON p.product_id = s.product_id)
ORDER BY
  average_income ASC;
